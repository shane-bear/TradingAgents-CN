# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

TradingAgents-CN æ˜¯åŸºäºå¤šæ™ºèƒ½ä½“å¤§è¯­è¨€æ¨¡å‹çš„ä¸­æ–‡é‡‘èäº¤æ˜“å†³ç­–æ¡†æ¶ï¼Œä¸“ä¸ºä¸­æ–‡ç”¨æˆ·ä¼˜åŒ–ï¼Œæä¾›å®Œæ•´çš„Aè‚¡/æ¸¯è‚¡/ç¾è‚¡åˆ†æèƒ½åŠ›ã€‚

## ğŸš€ å¼€å‘å‘½ä»¤

### å®‰è£…ä¾èµ–
```bash
# ä½¿ç”¨ pip (æ¨è)
pip install -e .

# ä½¿ç”¨ uv
uv pip install -e .

# å®‰è£…ç™¾åº¦åƒå¸†æ”¯æŒ (å¯é€‰)
pip install -e .[qianfan]
```

### Docker éƒ¨ç½² (ç”Ÿäº§ç¯å¢ƒæ¨è)
```bash
# ä¸€é”®æ„å»ºå¯åŠ¨
docker-compose up -d --build

# åˆ†æ­¥æ„å»º
docker build -t tradingagents-cn:latest .
docker-compose up -d
```

### Web åº”ç”¨å¯åŠ¨
```bash
# ä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)
python start_web.py

# ç›´æ¥å¯åŠ¨ Streamlit
streamlit run web/app.py --server.port 8501
```

### æµ‹è¯•è¿è¡Œ
```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
python tests/test_akshare_functionality.py

# è¿è¡Œ CLI æµ‹è¯•
python -m tradingagents.cli.main --stock 601127 --date 2024-05-10
```

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

### æ ¸å¿ƒæ¨¡å—ç»“æ„
```
tradingagents/
â”œâ”€â”€ agents/           # æ™ºèƒ½ä½“ç³»ç»Ÿ
â”‚   â”œâ”€â”€ analysts/     # åˆ†æå¸ˆ (å¸‚åœºã€æ–°é—»ã€åŸºæœ¬é¢ã€ç¤¾äº¤åª’ä½“)
â”‚   â”œâ”€â”€ managers/     # ç®¡ç†è§’è‰² (ç ”ç©¶ã€é£é™©)
â”‚   â”œâ”€â”€ researchers/  # ç ”ç©¶å‘˜ (å¤šå¤´ã€ç©ºå¤´)
â”‚   â””â”€â”€ risk_mgmt/    # é£é™©è¾©è®ºå™¨
â”œâ”€â”€ dataflows/        # æ•°æ®æµç®¡ç†
â”‚   â”œâ”€â”€ cache_manager.py     # ç¼“å­˜ç®¡ç†
â”‚   â”œâ”€â”€ data_source_manager.py # æ•°æ®æºç®¡ç†
â”‚   â””â”€â”€ *utils.py           # å„æ•°æ®æºå·¥å…· (akshare, tushare, finnhubç­‰)
â”œâ”€â”€ graph/            # å›¾æ‰§è¡Œå¼•æ“
â”‚   â”œâ”€â”€ trading_graph.py    # ä¸»å›¾ç±»
â”‚   â”œâ”€â”€ propagation.py      # ä¼ æ’­é€»è¾‘
â”‚   â””â”€â”€ reflection.py       # åæ€æœºåˆ¶
â”œâ”€â”€ llm_adapters/     # LLM é€‚é…å™¨
â”‚   â”œâ”€â”€ openai_compatible_base.py # åŸºç¡€é€‚é…å™¨
â”‚   â”œâ”€â”€ dashscope_adapter.py      # é˜¿é‡Œé€šä¹‰åƒé—®
â”‚   â”œâ”€â”€ google_openai_adapter.py  # Google AI
â”‚   â”œâ”€â”€ deepseek_adapter.py       # æ·±åº¦æ±‚ç´¢
â”‚   â””â”€â”€ baidu_qianfan_adapter.py  # ç™¾åº¦åƒå¸† (æ–°å¢)
â””â”€â”€ utils/            # å·¥å…·ç±»
    â”œâ”€â”€ logging_manager.py  # æ—¥å¿—ç®¡ç†
    â””â”€â”€ config_manager.py    # é…ç½®ç®¡ç†
```

### å…³é”®é…ç½®æ–‡ä»¶
- `.env` - ç¯å¢ƒå˜é‡é…ç½® (ä» `.env.example` å¤åˆ¶)
- `pyproject.toml` - é¡¹ç›®ä¾èµ–é…ç½® (ä¸»é…ç½®æ–‡ä»¶)
- `requirements.txt` - é—ç•™ä¾èµ–æ–‡ä»¶ (å·²å¼ƒç”¨)
- `default_config.py` - é»˜è®¤è¿è¡Œæ—¶é…ç½®

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### 1. ç¯å¢ƒè®¾ç½®
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶å¡«å…¥ API å¯†é’¥
```

### 2. ä¾èµ–ç®¡ç†
- ä½¿ç”¨ `pyproject.toml` ç®¡ç†ä¸»è¦ä¾èµ–
- å¯é€‰ä¾èµ–åœ¨ `[project.optional-dependencies]` ä¸­å®šä¹‰
- ä½¿ç”¨ `uv` æˆ– `pip` è¿›è¡Œå®‰è£…

### 3. æµ‹è¯•ç­–ç•¥
- æµ‹è¯•æ–‡ä»¶ä½äº `tests/` ç›®å½•
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•è„šæœ¬
- æµ‹è¯•è¦†ç›–æ•°æ®æºã€LLMé€‚é…å™¨ã€æ™ºèƒ½ä½“ç­‰åŠŸèƒ½

## ğŸŒ API é›†æˆ

### æ”¯æŒçš„ LLM æä¾›å•†
- OpenAI (åŸç”Ÿæ”¯æŒ)
- Google AI (Gemini 2.5/2.0)
- é˜¿é‡Œé€šä¹‰åƒé—® (DashScope)
- æ·±åº¦æ±‚ç´¢ (DeepSeek)
- ç™¾åº¦åƒå¸† (ERNIE, å¯é€‰)

### æ•°æ®æºé›†æˆ
- **Aè‚¡**: AKShare, Tushare, Baostock
- **æ¸¯è‚¡**: EODHD, Finnhub
- **ç¾è‚¡**: Yahoo Finance, Finnhub
- **æ–°é—»**: Google News, Reddit, Finnhub News

## ğŸ“Š ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—ç³»ç»Ÿ
- ç»Ÿä¸€æ—¥å¿—ç®¡ç†åœ¨ `utils/logging_manager.py`
- æ”¯æŒåˆ†çº§æ—¥å¿—å’Œä¸Šä¸‹æ–‡ä¿¡æ¯
- Token ä½¿ç”¨è·Ÿè¸ªå’Œæˆæœ¬è®¡ç®—

### æ•°æ®åº“
- MongoDB ç”¨äºç”¨æˆ·ç®¡ç†å’Œ Token è®°å½•
- Redis ç”¨äºç¼“å­˜å’Œä¼šè¯ç®¡ç†
- é…ç½®åœ¨ `.env` ä¸­è®¾ç½®

## ğŸ³ Docker éƒ¨ç½²

### æœåŠ¡ç»„æˆ
- **Web åº”ç”¨**: Streamlit (ç«¯å£ 8501)
- **æ•°æ®åº“**: MongoDB (ç«¯å£ 27017)
- **ç¼“å­˜**: Redis (ç«¯å£ 6379)
- **ç®¡ç†ç•Œé¢**: Mongo Express (ç«¯å£ 8081)

### å¼€å‘æ¨¡å¼
```bash
# å¼€å‘ç¯å¢ƒå¯åŠ¨
docker-compose -f docker-compose.yml up --build
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### åŠŸèƒ½æµ‹è¯•
- æ•°æ®æºè¿é€šæ€§æµ‹è¯•
- LLM é€‚é…å™¨é›†æˆæµ‹è¯•
- æ™ºèƒ½ä½“å·¥ä½œæµæµ‹è¯•
- ç”¨æˆ·æƒé™ç³»ç»Ÿæµ‹è¯•

### æ€§èƒ½æµ‹è¯•
- ç¼“å­˜æ€§èƒ½æµ‹è¯•
- å¹¶å‘å¤„ç†æµ‹è¯•
- å†…å­˜ä½¿ç”¨ç›‘æ§

## ğŸ” å®‰å…¨é…ç½®

- API å¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†
- ç”¨æˆ·è®¤è¯å’Œæƒé™æ§åˆ¶
- æ•°æ®åº“è¿æ¥åŠ å¯†
- è¾“å…¥éªŒè¯å’Œæ¸…ç†

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- å¤šçº§ç¼“å­˜ç³»ç»Ÿ (å†…å­˜ã€Redisã€æ•°æ®åº“)
- è‡ªé€‚åº”ç¼“å­˜è¿‡æœŸç­–ç•¥
- æ•°æ®é¢„å¤„ç†å’Œç´¢å¼•ä¼˜åŒ–

### å¹¶å‘å¤„ç†
- å¼‚æ­¥æ•°æ®è·å–
- æ‰¹é‡è¯·æ±‚å¤„ç†
- è¿æ¥æ± ç®¡ç†

## ğŸ”„ ç‰ˆæœ¬ç®¡ç†

- ç‰ˆæœ¬å·åœ¨ `VERSION` æ–‡ä»¶ä¸­å®šä¹‰
- éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
- Docker é•œåƒæ ‡ç­¾ä¸ç‰ˆæœ¬å·åŒæ­¥

## ğŸ“š æ–‡æ¡£èµ„æº

- `README.md` - é¡¹ç›®ä¸»æ–‡æ¡£
- `QUICKSTART.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `docs/` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- å­¦æœ¯è®ºæ–‡å’Œç ”ç©¶æˆæœåœ¨ `docs/` ç›®å½•

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æ¨¡å—å¯¼å…¥é”™è¯¯**: ç¡®ä¿å·²å®‰è£…ä¾èµ– `pip install -e .`
2. **API è¿æ¥å¤±è´¥**: æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„å¯†é’¥é…ç½®
3. **æ•°æ®åº“è¿æ¥é—®é¢˜**: ç¡®è®¤ MongoDB/Redis æœåŠ¡è¿è¡ŒçŠ¶æ€

### è°ƒè¯•å·¥å…·
- ä¸°å¯Œçš„æµ‹è¯•è„šæœ¬åœ¨ `tests/` å’Œ `scripts/` ç›®å½•
- æ—¥å¿—åˆ†æå·¥å…· `scripts/log_analyzer.py`
- Docker è°ƒè¯•è„šæœ¬ `scripts/debug_docker.*`

## ğŸ¯ å¼€å‘é‡ç‚¹

### æ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆçº§
1. LLM é€‚é…å™¨å…¼å®¹æ€§å’Œæ€§èƒ½
2. æ•°æ®æºç¨³å®šæ€§å’Œæ•°æ®è´¨é‡
3. ç”¨æˆ·æƒé™å’Œå®‰å…¨ç®¡ç†
4. ç¼“å­˜å’Œæ€§èƒ½ä¼˜åŒ–
5. æ–‡æ¡£å’Œæµ‹è¯•è¦†ç›–

### æ‰©å±•æ–¹å‘
- æ–°å¢å›½äº§å¤§æ¨¡å‹æ”¯æŒ
- æ›´å¤šæ•°æ®æºé›†æˆ
- é«˜çº§åˆ†æåŠŸèƒ½
- ç§»åŠ¨ç«¯é€‚é…
- ä¼ä¸šçº§éƒ¨ç½²æ–¹æ¡ˆ